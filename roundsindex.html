<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>통합 계산기 - 고기 & 사냥패스</title>
    
    <meta property="og:title" content="통합 계산기 - 고기 & 사냥패스">
    <meta property="og:description" content="사냥패스&고기 보상 계산">
    <meta property="og:image" content="https://noinvadepls.com/img/a.PNG">
    <meta property="og:url" content="https://noinvadepls.com/roundsindex">
    
    <style>
        /* 기본 리셋 및 폰트 설정 */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        
        :root {
            --primary: #7C4DFF;
            --primary-dark: #5E35B1;
            --primary-light: #B39DDB;
            --accent: #FF4081;
            --accent-dark: #F50057;
            --text-primary: #333333;
            --text-secondary: #757575;
            --background: #F5F5F5;
            --card-bg: #FFFFFF;
            --card-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            --input-border: #E0E0E0;
            --success: #4CAF50;
            --error: #F44336;
            --warning: #FFC107;
            --info: #2196F3;
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Noto Sans KR', sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
            font-size: 16px;
            overflow-x: hidden;
        }

        /* 헤더 스타일 */
        .site-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .site-header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            z-index: 2;
            position: relative;
        }

        .site-header p {
            font-size: 1.1rem;
            opacity: 0.9;
            z-index: 2;
            position: relative;
        }

        .site-header::before {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            background: url('./img/back1.png');
            background-size: cover;
            opacity: 0.1;
            top: -50%;
            left: -50%;
            animation: rotate 60s linear infinite;
            z-index: 1;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* 메인 컨테이너 */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .calculators-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: -3rem;
        }

        /* 카드 공통 스타일 */
        .card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            transition: var(--transition);
            overflow: hidden;
            height: 100%;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }

        .card-header {
            padding: 1.5rem;
            background: linear-gradient(45deg, var(--primary-dark), var(--primary));
            color: white;
            position: relative;
            overflow: hidden;
        }

        .card-header h2 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
        }

        .card-header::after {
            content: '';
            position: absolute;
            bottom: -10px;
            right: -10px;
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .meat-card .card-header {
            background: linear-gradient(45deg, #FF5722, #FF9800);
        }

        .meat-card .card-header::after {
            background: rgba(255, 255, 255, 0.15);
            width: 120px;
            height: 120px;
        }

        .card-body {
            padding: 1.5rem;
        }

        /* 입력 필드 스타일 */
        .input-group {
            margin-bottom: 1.5rem;
        }

        .input-group label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .input-group input[type="number"],
        .input-group input[type="text"] {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 2px solid var(--input-border);
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
            background-color: rgba(255, 255, 255, 0.8);
        }

        .input-group input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(124, 77, 255, 0.2);
        }

        .input-group .tip {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 0.3rem;
        }

        /* 체크박스 스타일 */
        .checkbox-container {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
            cursor: pointer;
        }

        .checkbox-container input[type="checkbox"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .checkmark {
            position: relative;
            display: inline-block;
            height: 22px;
            width: 22px;
            background-color: #f5f5f5;
            border: 2px solid var(--input-border);
            border-radius: 4px;
            margin-right: 10px;
            transition: var(--transition);
        }

        .checkbox-container:hover input ~ .checkmark {
            background-color: #e0e0e0;
        }

        .checkbox-container input:checked ~ .checkmark {
            background-color: var(--primary);
            border-color: var(--primary);
        }

        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
            left: 7px;
            top: 3px;
            width: 5px;
            height: 10px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }

        .checkbox-container input:checked ~ .checkmark:after {
            display: block;
        }

        .checkbox-container label {
            user-select: none;
        }

        /* 라디오 버튼 스타일 */
        .radio-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin-bottom: 1.5rem;
        }

        .radio-group.difficulty-buttons {
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
        }

        .radio-button {
            position: relative;
        }

        .radio-button input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .radio-button label {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem 0.5rem;
            border: 2px solid var(--input-border);
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            height: 70px;
            user-select: none;
        }

        .radio-button:hover label {
            border-color: var(--primary-light);
            background-color: rgba(179, 157, 219, 0.1);
        }

        .radio-button input:checked + label {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(124, 77, 255, 0.3);
        }

        .meat-card .radio-button input:checked + label {
            background-color: #FF5722;
            border-color: #FF5722;
            box-shadow: 0 4px 12px rgba(255, 87, 34, 0.3);
        }

        /* 결과 영역 스타일 */
        .result-area {
            margin-top: 1.5rem;
            background-color: rgba(245, 245, 245, 0.5);
            border-radius: 10px;
            padding: 1.2rem;
        }

        .result-section {
            margin-bottom: 1rem;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 0.7rem 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-label {
            font-weight: 500;
            color: var(--text-primary);
        }

        .result-value {
            font-weight: 600;
            color: var(--primary);
        }

        .meat-card .result-value {
            color: #FF5722;
        }

        .error-message {
            color: var(--error);
            font-weight: bold;
            margin-bottom: 1rem;
        }

        /* 진행 바 스타일 */
        .progress-container {
            margin: 1.2rem 0;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .progress-bar {
            height: 8px;
            background-color: rgba(0, 0, 0, 0.05);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-light), var(--primary));
            border-radius: 4px;
            width: 0;
            transition: width 0.6s cubic-bezier(0.65, 0, 0.35, 1);
        }

        /* 접을 수 있는 섹션 스타일 */
        .collapsible {
            margin-top: 1.2rem;
            border: 1px solid rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            overflow: hidden;
        }

        .collapsible-header {
            padding: 1rem;
            background-color: rgba(0, 0, 0, 0.02);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            user-select: none;
            font-weight: 500;
            transition: var(--transition);
        }

        .collapsible-header:hover {
            background-color: rgba(0, 0, 0, 0.04);
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            background-color: white;
        }

        .collapsible-content.open {
            max-height: 500px;
            padding: 1rem;
        }

        /* 아이콘 네비게이션 스타일 */
        .icon-navigation {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        .nav-icon {
            position: relative;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            overflow: hidden;
            background-color: white;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .nav-icon:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .nav-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .nav-icon span {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.6);
            color: white;
            font-size: 0.7rem;
            padding: 4px 0;
            text-align: center;
        }

        /* 애니메이션 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            animation: fadeIn 0.5s ease-out forwards;
        }

        .meat-card {
            animation-delay: 0.1s;
        }

        .hunt-card {
            animation-delay: 0.2s;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 0.3s ease-in-out;
        }

        /* 반응형 스타일 */
        @media (max-width: 1024px) {
            .calculators-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .site-header h1 {
                font-size: 2rem;
            }

            .container {
                padding: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .card-header h2 {
                font-size: 1.5rem;
            }

            .radio-group {
                grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            }

            .radio-button label {
                padding: 0.8rem 0.3rem;
                font-size: 0.8rem;
                height: 60px;
            }
        }

        @media (max-width: 480px) {
            .site-header h1 {
                font-size: 1.6rem;
            }

            .site-header p {
                font-size: 0.9rem;
            }

            .radio-group {
                grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
            }

            .radio-button label {
                padding: 0.6rem 0.2rem;
                font-size: 0.75rem;
                height: 50px;
            }

            .nav-icon {
                width: 50px;
                height: 50px;
            }
        }

        /* 접근성 관련 */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* 푸터 스타일 */
        .footer {
            margin-top: 3rem;
            text-align: center;
            padding: 2rem 0;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
    </style>
</head>

<body>
    <header class="site-header">
        <h1>고기 & 사냥패스 통합 계산기</h1>
        <p>게임 보상을 정확하게 계산하고 사냥패스 진행 상황을 추적하세요</p>
    </header>

    <div class="container">
        <div class="calculators-grid">
            <!-- 고기 계산기 -->
            <div class="card meat-card">
                <div class="card-header">
                    <h2>고기 계산기</h2>
                </div>
                <div class="card-body">
                    <!-- 입력 섹션 -->
                    <div class="input-group">
                        <label for="meat-input">입력값:</label>
                        <input type="text" id="meat-input" inputmode="numeric" pattern="[0-9]*" placeholder="정수를 입력하세요" aria-describedby="meat-input-error">
                    </div>

                    <!-- 입력 타입 라디오 버튼 -->
                    <div class="input-group">
                        <label id="input-type-label">입력 타입 선택:</label>
                        <div class="radio-group input-type" role="radiogroup" aria-labelledby="input-type-label">
                            <div class="radio-button">
                                <input type="radio" id="type-meat" name="inputType" value="meat" checked>
                                <label for="type-meat">고기<br>개수</label>
                            </div>
                            <div class="radio-button">
                                <input type="radio" id="type-round" name="inputType" value="round">
                                <label for="type-round">판수</label>
                            </div>
                            <div class="radio-button">
                                <input type="radio" id="type-마족" name="inputType" value="마족 소환권">
                                <label for="type-마족">마족<br>소환권</label>
                            </div>
                            <div class="radio-button">
                                <input type="radio" id="type-골드" name="inputType" value="골드">
                                <label for="type-골드">골드</label>
                            </div>
                            <div class="radio-button">
                                <input type="radio" id="type-다이아" name="inputType" value="다이아">
                                <label for="type-다이아">다이아</label>
                            </div>
                        </div>
                    </div>

                    <!-- 난이도 버튼 섹션 -->
                    <div class="input-group">
                        <label id="difficulty-label">난이도 선택:</label>
                        <div class="radio-group difficulty-buttons" role="radiogroup" aria-labelledby="difficulty-label">
                            <div class="radio-button">
                                <input type="radio" id="difficulty-ss" name="difficulty" value="SS" checked>
                                <label for="difficulty-ss">SS</label>
                            </div>
                            <div class="radio-button">
                                <input type="radio" id="difficulty-hard" name="difficulty" value="어려움">
                                <label for="difficulty-hard">어려움</label>
                            </div>
                            <div class="radio-button">
                                <input type="radio" id="difficulty-very-hard" name="difficulty" value="매우 어려움">
                                <label for="difficulty-very-hard">매우<br>어려움</label>
                            </div>
                            <div class="radio-button">
                                <input type="radio" id="difficulty-easy" name="difficulty" value="쉬움">
                                <label for="difficulty-easy">쉬움</label>
                            </div>
                            <div class="radio-button">
                                <input type="radio" id="difficulty-hell" name="difficulty" value="불지옥">
                                <label for="difficulty-hell">불지옥</label>
                            </div>
                        </div>
                    </div>

                    <div id="result" class="result-area">
                        <p id="error-msg" class="error-message" aria-live="assertive"></p>
                        <div class="result-section">
                            <div class="result-item">
                                <span class="result-label">시작 시간:</span>
                                <span id="start-time"></span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">종료 시간:</span>
                                <span id="end-time"></span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">게임 판수:</span>
                                <span id="rounds"></span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">예상 시간:</span>
                                <span id="estimated-time"></span>
                            </div>
                        </div>
                        <div class="result-section">
                            <div class="result-item">
                                <span class="result-label">보상:</span>
                                <span id="rewards"></span>
                            </div>
                        </div>
                    </div>

                    <!-- 아이콘 네비게이션 -->
                    <div class="icon-navigation">
                        <div class="nav-icon" onclick="navigate('길드대전.html')">
                            <img src="./img/1.png" alt="길드">
                            <span>길드</span>
                        </div>
                        <div class="nav-icon" onclick="navigate('월드보스1.html')">
                            <img src="./img/1m.png" alt="보스1">
                            <span>보스1</span>
                        </div>
                        <div class="nav-icon" onclick="navigate('월드보스2.html')">
                            <img src="./img/4m.png" alt="보스2">
                            <span>보스2</span>
                        </div>
                        <div class="nav-icon" onclick="navigate('월드보스3.html')">
                            <img src="./img/5m.png" alt="보스3">
                            <span>보스3</span>
                        </div>
                        <div class="nav-icon" onclick="navigate('일반.html')">
                            <img src="./img/2m.png" alt="일반">
                            <span>일반</span>
                        </div>
                        <div class="nav-icon" onclick="navigate('어려움.html')">
                            <img src="./img/3m.png" alt="어려움">
                            <span>어려움</span>
                        </div>
                        <div class="nav-icon" onclick="navigate('index.html')">
                            <img src="./img/A.PNG" alt="홈">
                            <span>홈</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 사냥패스 레벨 계산기 -->
            <div class="card hunt-card">
                <div class="card-header">
                    <h2>사냥패스 레벨 계산기</h2>
                </div>
                <div class="card-body">
                    <div class="input-group">
                        <label for="currentLevel">현재 레벨</label>
                        <input type="number" id="currentLevel" min="1" max="79" step="1" inputmode="numeric" value="1" aria-describedby="current-level-tip">
                        <div class="tip" id="current-level-tip">1~79 사이의 값</div>
                    </div>

                    <div class="input-group">
                        <label for="currentExp">현재 경험치</label>
                        <input type="number" id="currentExp" min="0" step="1" inputmode="numeric" value="0" aria-describedby="current-exp-tip">
                        <div class="tip" id="current-exp-tip">현재 레벨에서 모은 경험치</div>
                    </div>

                    <div class="input-group">
                        <label for="gamesPerDay">플레이할 판수</label>
                        <input type="number" id="gamesPerDay" min="1" step="1" inputmode="numeric" value="10">
                    </div>

                    <div class="checkbox-container">
                        <input type="checkbox" id="doubleExp" checked aria-describedby="double-exp-description">
                        <span class="checkmark"></span>
                        <label for="doubleExp">하루 10판 2배 경험치</label>
                        <span id="double-exp-description" class="sr-only">하루 첫 10판은 경험치가 2배로 적용됩니다</span>
                    </div>
                    
                    <div class="input-group" id="remainingDoubleExpContainer">
                        <label for="remainingDoubleExp">남은 2배 경험치 판수</label>
                        <input type="number" id="remainingDoubleExp" min="0" max="10" value="10">
                        <div class="tip">오늘 남은 2배 경험치 판수</div>
                    </div>

                    <div class="result-area" id="resultCard">
                        <div class="progress-container">
                            <div class="progress-label">
                                <span>플레이 후 예상 진행도</span>
                                <span id="futureProgressPercent">0%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="futureProgressFill"></div>
                            </div>
                        </div>
                        
                        <div class="result-item">
                            <span class="result-label">플레이 후 예상 레벨</span>
                            <span class="result-value" id="futureLevel">0</span>
                        </div>
                        
                        <div class="result-item">
                            <span class="result-label">플레이 후 예상 경험치</span>
                            <span class="result-value" id="futureExp">0</span>
                        </div>
                        
                        <div class="collapsible">
                            <div class="collapsible-header" id="maxLevelHeader">
                                <span>80레벨 달성 정보</span>
                                <span>▼</span>
                            </div>
                            <div class="collapsible-content" id="maxLevelInfo">
                                <div class="result-item">
                                    <span class="result-label">80레벨 달성 판수</span>
                                    <span class="result-value" id="maxLevelGames">0판</span>
                                </div>
                                
                                <div class="result-item">
                                    <span class="result-label">리셋 후 도달 레벨</span>
                                    <span class="result-value" id="resetLevel">0</span>
                                </div>
                                
                                <div class="result-item">
                                    <span class="result-label">리셋 후 예상 경험치</span>
                                    <span class="result-value" id="resetExp">0</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="collapsible">
                            <div class="collapsible-header" id="detailsHeader">
                                <span>상세 정보</span>
                                <span>▼</span>
                            </div>
                            <div class="collapsible-content" id="detailsContent">
                                <div class="progress-container">
                                    <div class="progress-label">
                                        <span>현재 진행도</span>
                                        <span id="progressPercent">0%</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="progressFill"></div>
                                    </div>
                                </div>

                                <div class="result-item">
                                    <span class="result-label">다음 레벨까지</span>
                                    <span class="result-value" id="nextLevelGames">0판</span>
                                </div>

                                <div class="result-item">
                                    <span class="result-label">만렙까지 필요한 총 판수</span>
                                    <span class="result-value" id="totalGames">0판</span>
                                </div>
                                
                                <div class="result-item">
                                    <span class="result-label">2배 경험치 적용 판수</span>
                                    <span class="result-value" id="actualTotalGames">0판</span>
                                </div>

                                <div class="result-item">
                                    <span class="result-label">만렙까지 남은 경험치</span>
                                    <span class="result-value" id="remainingExp">0</span>
                                </div>

                                <div class="result-item">
                                    <span class="result-label">만렙까지 예상 소요 일수</span>
                                    <span class="result-value" id="estimatedDays">0일</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <p>© 2025 고기 & 사냥패스 통합 계산기</p>
    </footer>

    <script>
        // 유틸리티 함수 모듈
        const Utils = {
            // 날짜 형식 포맷팅 함수
            formatDate: function(date) {
                return `${date.getFullYear()}년 ${String(date.getMonth() + 1).padStart(2, '0')}월 ${String(date.getDate()).padStart(2, '0')}일 ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`;
            },
            
            // 숫자 천 단위 콤마 형식 지정
            formatNumber: function(number) {
                return number.toLocaleString();
            },
            
            // 0으로 나누기 방지
            safeDivide: function(numerator, denominator) {
                return denominator === 0 ? 0 : numerator / denominator;
            },
            
            // 요소에 일시적인 강조 효과 추가
            pulseEffect: function(element) {
                element.classList.add('pulse');
                setTimeout(() => {
                    element.classList.remove('pulse');
                }, 300);
            }
        };

        // 사냥패스 계산기 스크립트
        // 레벨별 필요 경험치 정의
        const levelExpTable = {
            1: 300,
            2: 400,
            3: 400,
            4: 500,
            5: 500,
            6: 700,
            7: 900,
            8: 1100,
            9: 1400,
            10: 1700,
            11: 2000,
            12: 2200
        };

        // 13레벨부터 80레벨까지는 2400 경험치
        for (let i = 13; i <= 80; i++) {
            levelExpTable[i] = 2400;
        }

        // 사냥패스 최대 레벨
        const MAX_LEVEL = 80;

        // 한 판당 기본 경험치
        const BASE_EXP_PER_GAME = 800;

        // DOM 요소
        const currentLevelInput = document.getElementById('currentLevel');
        const currentExpInput = document.getElementById('currentExp');
        const gamesPerDayInput = document.getElementById('gamesPerDay');
        const doubleExpCheckbox = document.getElementById('doubleExp');
        const remainingDoubleExpInput = document.getElementById('remainingDoubleExp');
        const remainingDoubleExpContainer = document.getElementById('remainingDoubleExpContainer');
        const resultCard = document.getElementById('resultCard');
        const nextLevelGames = document.getElementById('nextLevelGames');
        const totalGames = document.getElementById('totalGames');
        const actualTotalGames = document.getElementById('actualTotalGames');
        const remainingExp = document.getElementById('remainingExp');
        const estimatedDays = document.getElementById('estimatedDays');
        const progressFill = document.getElementById('progressFill');
        const progressPercent = document.getElementById('progressPercent');
        const futureProgressFill = document.getElementById('futureProgressFill');
        const futureProgressPercent = document.getElementById('futureProgressPercent');
        const futureLevel = document.getElementById('futureLevel');
        const futureExp = document.getElementById('futureExp');
        const maxLevelInfo = document.getElementById('maxLevelInfo');
        const maxLevelGames = document.getElementById('maxLevelGames');
        const resetLevel = document.getElementById('resetLevel');
        const resetExp = document.getElementById('resetExp');
        const maxLevelHeader = document.getElementById('maxLevelHeader');
        const detailsHeader = document.getElementById('detailsHeader');
        const detailsContent = document.getElementById('detailsContent');

        // 접을 수 있는 섹션 추가
        function toggleCollapsible(header, content) {
            header.addEventListener('click', function() {
                content.classList.toggle('open');
                const arrow = header.querySelector('span:last-child');
                arrow.textContent = content.classList.contains('open') ? '▲' : '▼';
                
                // 접근성을 위한 aria 속성 업데이트
                header.setAttribute('aria-expanded', content.classList.contains('open'));
                
                // 효과 추가
                Utils.pulseEffect(content);
            });
            
            // 초기 aria 속성 설정
            header.setAttribute('aria-expanded', 'false');
            header.setAttribute('role', 'button');
            header.setAttribute('tabindex', '0');
            
            // 키보드 접근성 추가
            header.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    this.click();
                }
            });
        }

        // 2배 경험치 체크박스 상태에 따라 남은 2배 경험치 판수 입력란 표시/숨김
        function toggleRemainingDoubleExpField() {
            remainingDoubleExpContainer.style.display = doubleExpCheckbox.checked ? 'block' : 'none';
        }

        // 현재 레벨의 필요 경험치 가져오기
        function getLevelExp(level) {
            return levelExpTable[level] || 2400; // 정의되지 않은 레벨은 2400 반환
        }

        // 총 필요 경험치 계산 (현재 레벨부터 만렙까지)
        function calculateTotalExpNeeded(currentLevel, currentExp) {
            let totalExp = getLevelExp(currentLevel) - currentExp;
            
            for (let level = currentLevel + 1; level < MAX_LEVEL; level++) {
                totalExp += getLevelExp(level);
            }
            
            return totalExp;
        }

        // 필요한 총 판수 계산 (항상 2배 경험치 미적용)
        function calculateTotalGamesNeeded(totalExp) {
            // 항상 2배 경험치 미적용으로 계산
            return Math.ceil(totalExp / BASE_EXP_PER_GAME);
        }
        
        // 필요한 판수 계산 (하루 플레이 판수 고려)
        function calculateDaysGamesNeeded(totalExp, gamesPerDay, useDoubleExp) {
            let remainingExp = totalExp;
            let totalGames = 0;
            
            while (remainingExp > 0) {
                let dailyGames = 0;
                let dailyMaxGames = gamesPerDay;
                
                // 하루 10판까지 2배 경험치 적용
                if (useDoubleExp) {
                    while (dailyGames < 10 && dailyGames < dailyMaxGames && remainingExp > 0) {
                        remainingExp -= (BASE_EXP_PER_GAME * 2);
                        dailyGames++;
                        totalGames++;
                    }
                }
                
                // 나머지 판수는 기본 경험치
                while (dailyGames < dailyMaxGames && remainingExp > 0) {
                    remainingExp -= BASE_EXP_PER_GAME;
                    dailyGames++;
                    totalGames++;
                }
            }
            
            return totalGames;
        }

        // 다음 레벨까지 필요한 판수 계산
        function calculateNextLevelGames(currentLevel, currentExp, useDoubleExp) {
            const expNeeded = getLevelExp(currentLevel) - currentExp;
            
            if (useDoubleExp) {
                // 2배 경험치 적용
                return Math.ceil(expNeeded / (BASE_EXP_PER_GAME * 2));
            } else {
                // 기본 경험치 적용
                return Math.ceil(expNeeded / BASE_EXP_PER_GAME);
            }
        }
        
        // 실제 필요한 판수 계산 (2배 경험치 고려)
        function calculateActualGamesNeeded(totalExp, useDoubleExp, remainingDoubleExpGames) {
            if (!useDoubleExp) {
                // 2배 경험치 미적용 시 기본 계산
                return Math.ceil(totalExp / BASE_EXP_PER_GAME);
            }
            
            let remainingExp = totalExp;
            let totalGames = 0;
            
            // 남은 2배 경험치 판수로 먼저 계산
            const doubleExpGames = Math.min(remainingDoubleExpGames, Math.ceil(remainingExp / (BASE_EXP_PER_GAME * 2)));
            remainingExp -= doubleExpGames * (BASE_EXP_PER_GAME * 2);
            totalGames += doubleExpGames;
            
            // 나머지 경험치는 일반 판수로 계산
            if (remainingExp > 0) {
                totalGames += Math.ceil(remainingExp / BASE_EXP_PER_GAME);
            }
            
            return totalGames;
        }

        // 전체 진행률 계산
        function calculateProgress(currentLevel, currentExp) {
            let totalExpToMax = 0;
            let earnedExp = 0;
            
            // 1레벨부터 최대 레벨까지 총 경험치
            for (let level = 1; level < MAX_LEVEL; level++) {
                totalExpToMax += getLevelExp(level);
            }
            
            // 현재까지 획득한 경험치
            for (let level = 1; level < currentLevel; level++) {
                earnedExp += getLevelExp(level);
            }
            earnedExp += currentExp;
            
            return (earnedExp / totalExpToMax) * 100;
        }

        // 플레이 후 예상 레벨 및 경험치 계산 (게임별 상세 추적)
        function calculateFutureProgressDetailed(currentLevel, currentExp, gamesToPlay, useDoubleExp, remainingDoubleExpGames) {
            let level = currentLevel;
            let exp = currentExp;
            let gamesPlayed = 0;
            let maxLevelReached = false;
            let maxLevelAtGame = 0;
            let remainingGames = 0;
            let resetLevelInfo = { level: 1, exp: 0 };
            
            // 남은 2배 경험치 판수 추적
            let availableDoubleExpGames = useDoubleExp ? remainingDoubleExpGames : 0;
            
            // 한 게임씩 진행 상황 추적
            while (gamesPlayed < gamesToPlay) {
                // 현재 게임 경험치 계산
                let gameExp = BASE_EXP_PER_GAME;
                if (availableDoubleExpGames > 0) {
                    gameExp *= 2;
                    availableDoubleExpGames--;
                }
                
                // 경험치 추가 및 레벨업 체크
                exp += gameExp;
                gamesPlayed++;
                
                // 레벨업 체크
                while (exp >= getLevelExp(level) && level < MAX_LEVEL) {
                    exp -= getLevelExp(level);
                    level++;
                    
                    // 80레벨 도달 체크
                    if (level === MAX_LEVEL && !maxLevelReached) {
                        maxLevelReached = true;
                        maxLevelAtGame = gamesPlayed;
                        remainingGames = gamesToPlay - gamesPlayed;
                        
                        // 리셋 후 새로운 사이클 시작
                        if (remainingGames > 0) {
                            let resetLevel = 1;
                            let resetExp = 0;
                            let resetGamesPlayed = 0;
                            let resetAvailableDoubleExpGames = availableDoubleExpGames;
                            
                            // 남은 게임으로 다시 1레벨부터 시작
                            while (resetGamesPlayed < remainingGames) {
                                let resetGameExp = BASE_EXP_PER_GAME;
                                if (resetAvailableDoubleExpGames > 0) {
                                    resetGameExp *= 2;
                                    resetAvailableDoubleExpGames--;
                                }
                                
                                resetExp += resetGameExp;
                                resetGamesPlayed++;
                                
                                // 리셋 후 레벨업 체크
                                while (resetExp >= getLevelExp(resetLevel) && resetLevel < MAX_LEVEL) {
                                    resetExp -= getLevelExp(resetLevel);
                                    resetLevel++;
                                }
                            }
                            
                            resetLevelInfo = { level: resetLevel, exp: resetExp };
                        }
                    }
                }
            }
            
            return { 
                level, 
                exp, 
                maxLevelReached, 
                maxLevelAtGame, 
                remainingGames,
                resetLevelInfo
            };
        }

        // 계산 실행
        function calculateHuntingPass() {
            const currentLevel = parseInt(currentLevelInput.value) || 1;
            const currentExp = parseInt(currentExpInput.value) || 0;
            const gamesPerDay = parseInt(gamesPerDayInput.value) || 1;
            const useDoubleExp = doubleExpCheckbox.checked;
            const remainingDoubleExpGames = useDoubleExp ? (parseInt(remainingDoubleExpInput.value) || 0) : 0;
            
            // 입력값 유효성 검사
            if (currentLevel < 1 || currentLevel >= MAX_LEVEL) {
                currentLevelInput.value = Math.min(Math.max(1, currentLevel), MAX_LEVEL - 1);
                return calculateHuntingPass();
            }
            
            if (currentExp < 0 || currentExp >= getLevelExp(currentLevel)) {
                currentExpInput.value = Math.min(Math.max(0, currentExp), getLevelExp(currentLevel) - 1);
                return calculateHuntingPass();
            }
            
            if (gamesPerDay < 1) {
                gamesPerDayInput.value = 1;
                return calculateHuntingPass();
            }
            
            if (remainingDoubleExpGames < 0 || remainingDoubleExpGames > 10) {
                remainingDoubleExpInput.value = Math.min(Math.max(0, remainingDoubleExpGames), 10);
                return calculateHuntingPass();
            }
            
            // 계산 수행
            const totalExpNeeded = calculateTotalExpNeeded(currentLevel, currentExp);
            const totalGamesNeeded = calculateTotalGamesNeeded(totalExpNeeded); // 항상 2배 경험치 미적용
            const daysGamesNeeded = calculateDaysGamesNeeded(totalExpNeeded, gamesPerDay, useDoubleExp);
            const gamesForNextLevel = calculateNextLevelGames(currentLevel, currentExp, useDoubleExp);
            const daysEstimated = Math.ceil(daysGamesNeeded / gamesPerDay);
            const progress = calculateProgress(currentLevel, currentExp);
            
            // 실제 필요한 판수 계산 (2배 경험치 고려)
            const actualGamesNeeded = calculateActualGamesNeeded(totalExpNeeded, useDoubleExp, remainingDoubleExpGames);
            
            // 플레이 후 예상 레벨 및 경험치 계산 (상세 추적)
            const futureDetailed = calculateFutureProgressDetailed(currentLevel, currentExp, gamesPerDay, useDoubleExp, remainingDoubleExpGames);
            const futureProgress = calculateProgress(futureDetailed.level, futureDetailed.exp);
            
            // 결과 표시
            nextLevelGames.textContent = `${gamesForNextLevel}판`;
            totalGames.textContent = `${totalGamesNeeded}판`;
            actualTotalGames.textContent = `${actualGamesNeeded}판`;
            remainingExp.textContent = Utils.formatNumber(totalExpNeeded);
            estimatedDays.textContent = `${daysEstimated}일`;
            
            progressFill.style.width = `${progress}%`;
            progressPercent.textContent = `${progress.toFixed(1)}%`;
            
            futureProgressFill.style.width = `${futureProgress}%`;
            futureProgressPercent.textContent = `${futureProgress.toFixed(1)}%`;
            futureLevel.textContent = `${futureDetailed.level}레벨`;
            
            const expNeeded = getLevelExp(futureDetailed.level);
            futureExp.textContent = `${futureDetailed.exp}/${expNeeded} (${((futureDetailed.exp / expNeeded) * 100).toFixed(1)}%)`;
            
            // 80레벨 달성 정보 표시
            if (futureDetailed.maxLevelReached) {
                maxLevelHeader.style.display = 'flex';
                maxLevelGames.textContent = `${futureDetailed.maxLevelAtGame}판`;
                
                const resetLevelData = futureDetailed.resetLevelInfo;
                resetLevel.textContent = `${resetLevelData.level}레벨`;
                
                const resetExpNeeded = getLevelExp(resetLevelData.level);
                resetExp.textContent = `${resetLevelData.exp}/${resetExpNeeded} (${((resetLevelData.exp / resetExpNeeded) * 100).toFixed(1)}%)`;
            } else {
                maxLevelHeader.style.display = 'none';
            }
            
            // 변경된 결과 영역에 효과 추가
            Utils.pulseEffect(resultCard);
        }

        // 고기 계산기 스크립트
        // 보상 데이터
        const rewardsData = {
            "SS": { "마족 소환권": 6, "잡동사니 소환권": 6, 다이아: 480, 골드: 9600, 경험치: 3200, 잼: 80, 뺑뺑이: 240 },
            "어려움": { "마족 소환권": 6, "잡동사니 소환권": 6, 다이아: 480, 골드: 20000, 경험치: 3200, 잼: 80, 뺑뺑이: 240 },
            "매우 어려움": { "마족 소환권": 7, "잡동사니 소환권": 7, 다이아: 480, 골드: 30000, 경험치: 3200, 잼: 80, 뺑뺑이: 240 },
            "쉬움": { "마족 소환권": 2, "잡동사니 소환권": 2, 다이아: 160, 골드: 3200, 경험치: 3200, 잼: 80, 뺑뺑이: 240 },
            "불지옥": { "마족 소환권": 7, "잡동사니 소환권": 7, 다이아: 480, 골드: 40000, 경험치: 3200, 잼: 80, 뺑뺑이: 240 }
        };

        // 고기 계산 함수
        function calculateMeat() {
            const meatInput = document.getElementById('meat-input');
            const meatCount = parseInt(meatInput.value, 10);
            const difficulty = document.querySelector('input[name="difficulty"]:checked').value;
            const inputType = document.querySelector('input[name="inputType"]:checked').value;
            
            const errorMsgEl = document.getElementById('error-msg');
            const rewardsEl = document.getElementById('rewards');
            const startTimeEl = document.getElementById('start-time');
            const endTimeEl = document.getElementById('end-time');
            const roundsEl = document.getElementById('rounds');
            const estimatedTimeEl = document.getElementById('estimated-time');
            const resultArea = document.querySelector('.result-area');
            
            errorMsgEl.textContent = '';
            startTimeEl.textContent = '';
            endTimeEl.textContent = '';
            roundsEl.textContent = '';
            estimatedTimeEl.textContent = '';
            rewardsEl.innerHTML = '';
        
            if (isNaN(meatCount) || meatCount <= 0) {
                errorMsgEl.textContent = '정수를 입력하세요!';
                meatInput.classList.add('invalid');
                return;
            } else {
                meatInput.classList.remove('invalid');
            }
            
            let rounds;
            if (inputType === "meat") {
                const adjustedMeatCount = Math.floor(meatCount / 10) * 10;
                rounds = adjustedMeatCount / 10;
            } else if (inputType === "round") {
                rounds = meatCount;
            } else if (inputType === "마족 소환권" || inputType === "골드" || inputType === "다이아") {
                // 0으로 나누기 방지
                const divisor = rewardsData[difficulty][inputType] || 1;
                rounds = Math.ceil(meatCount / divisor);
            }
            
            const estimatedTime = rounds * 11;
            let estimatedTimeText = `${estimatedTime}분`;
            if (estimatedTime > 60) {
                const hours = Math.floor(estimatedTime / 60);
                const minutes = estimatedTime % 60;
                estimatedTimeText += ` (${hours}시간 ${minutes}분)`;
            }
            
            const startTime = new Date();
            const endTime = new Date(startTime.getTime() + estimatedTime * 60000);
            
            startTimeEl.textContent = `${Utils.formatDate(startTime)}`;
            endTimeEl.textContent = `${Utils.formatDate(endTime)}`;
            roundsEl.textContent = `${rounds}판`;
            estimatedTimeEl.textContent = `${estimatedTimeText}`;
            
            const rewards = rewardsData[difficulty];
            // 원하는 그룹 설정: [그룹1, 그룹2, 그룹3, 그룹4]
            const groups = [
                ["마족 소환권", "잡동사니 소환권"],
                ["다이아", "골드"],
                ["경험치", "잼"],
                ["뺑뺑이"]
            ];
        
            let rewardsHtml = '';
            
            groups.forEach((group, index) => {
                let groupHtml = '';
                group.forEach(key => {
                    if (groupHtml) groupHtml += ' / ';
                    groupHtml += `${key}: ${Utils.formatNumber(rewards[key] * rounds)}`;
                });
                
                if (index > 0) rewardsHtml += '<br>';
                rewardsHtml += groupHtml;
            });
        
            rewardsEl.innerHTML = rewardsHtml;
            
            // 결과 영역에 효과 추가
            Utils.pulseEffect(resultArea);
        }

        function navigate(page) {
            window.location.href = page;
        }

        // 이벤트 리스너 등록 - 사냥패스 계산기
        document.addEventListener('DOMContentLoaded', function() {
            // 접을 수 있는 섹션 설정
            toggleCollapsible(maxLevelHeader, maxLevelInfo);
            toggleCollapsible(detailsHeader, detailsContent);
            
            // 2배 경험치 체크박스 상태에 따라 남은 2배 경험치 판수 입력란 표시/숨김
            toggleRemainingDoubleExpField();
            
            // 입력값 변경 시 자동 계산 - 사냥패스 계산기
            currentLevelInput.addEventListener('input', calculateHuntingPass);
            currentExpInput.addEventListener('input', calculateHuntingPass);
            gamesPerDayInput.addEventListener('input', calculateHuntingPass);
            doubleExpCheckbox.addEventListener('change', function() {
                toggleRemainingDoubleExpField();
                calculateHuntingPass();
            });
            remainingDoubleExpInput.addEventListener('input', calculateHuntingPass);
            
            // 입력값 변경 시 자동 계산 - 고기 계산기
            document.getElementById('meat-input').addEventListener('input', calculateMeat);
            document.getElementById('meat-input').addEventListener('keydown', function(event) {
                if (event.key === 'Enter') calculateMeat();
            });
            
            // 입력 타입 라디오 버튼 실시간 업데이트
            document.querySelectorAll('input[name="inputType"]').forEach(button => {
                button.addEventListener('change', calculateMeat);
            });
            
            // 난이도 라디오 버튼 실시간 업데이트
            document.querySelectorAll('input[name="difficulty"]').forEach(button => {
                button.addEventListener('change', calculateMeat);
            });
            
            // 페이지 로드 시 자동 계산
            calculateHuntingPass();
            calculateMeat();
            
            // URL 파라미터 처리 (계산 결과 공유 위한 기능)
            try {
                const urlParams = new URLSearchParams(window.location.search);
                if (urlParams.has('level')) {
                    currentLevelInput.value = urlParams.get('level');
                }
                if (urlParams.has('exp')) {
                    currentExpInput.value = urlParams.get('exp');
                }
                if (urlParams.has('games')) {
                    gamesPerDayInput.value = urlParams.get('games');
                }
                if (urlParams.has('double')) {
                    doubleExpCheckbox.checked = urlParams.get('double') === '1';
                    toggleRemainingDoubleExpField();
                }
                if (urlParams.has('remaining')) {
                    remainingDoubleExpInput.value = urlParams.get('remaining');
                }
                if (urlParams.has('meat')) {
                    document.getElementById('meat-input').value = urlParams.get('meat');
                }
                if (urlParams.has('inputType')) {
                    const inputType = urlParams.get('inputType');
                    document.querySelector(`input[name="inputType"][value="${inputType}"]`).checked = true;
                }
                if (urlParams.has('difficulty')) {
                    const difficulty = urlParams.get('difficulty');
                    document.querySelector(`input[name="difficulty"][value="${difficulty}"]`).checked = true;
                }
                
                // URL 파라미터가 있으면 자동으로 계산 실행
                if (urlParams.toString()) {
                    calculateHuntingPass();
                    calculateMeat();
                }
            } catch (e) {
                console.error('URL 파라미터 처리 중 오류:', e);
            }
        });
    </script>
</body>
</html>