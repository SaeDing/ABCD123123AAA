<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Power Manager</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,0..200" rel="stylesheet">
<style>
:root {
    --primary: #007AFF;
    --primary-gradient: linear-gradient(135deg, #0A84FF, #0077FF);
    --secondary: #34C759;
    --secondary-gradient: linear-gradient(135deg, #30D158, #34C759);
    --danger: #FF3B30;
    --danger-gradient: linear-gradient(135deg, #FF453A, #FF3B30);
    --warning: #FF9500;
    --warning-gradient: linear-gradient(135deg, #FF9F0A, #FF9500);
    --dark: #1C1C1E;
    --light-dark: #2C2C2E;
    --medium: #8E8E93;
    --light-medium: #AEAEB2;
    --light: #F2F2F7;
    --ultra-light: #F9F9F9;
    --white: #FFFFFF;
    --border-radius-small: 10px;
    --border-radius-medium: 14px;
    --border-radius-large: 20px;
    --shadow-subtle: 0 2px 8px rgba(0, 0, 0, 0.05);
    --shadow-medium: 0 4px 12px rgba(0, 0, 0, 0.08);
    --transition: all 0.3s cubic-bezier(0.25, 0.1, 0.25, 1);
    
    /* Dark mode variables */
    --dark-bg: #000000;
    --dark-card: #1C1C1E;
    --dark-text: #FFFFFF;
    --dark-text-secondary: #AEAEB2;
    --dark-input-bg: #2C2C2E;
    --dark-border: #38383A;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;
    font-weight: 300;
    background-color: var(--ultra-light);
    color: var(--dark);
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

header {
    padding: 20px 0;
    text-align: center;
    margin-bottom: 20px;
}

h1 {
    font-weight: 300;
    font-size: 32px;
    margin-bottom: 5px;
    background: var(--primary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    letter-spacing: -0.5px;
}

h2 {
    font-weight: 400;
    font-size: 20px;
    margin-bottom: 10px;
    color: var(--dark);
    letter-spacing: -0.3px;
}

p {
    color: var(--medium);
    font-size: 15px;
    font-weight: 300;
}

.description {
    font-size: 16px;
    color: var(--medium);
    text-align: center;
    margin-bottom: 40px;
    font-weight: 300;
}

/* CARD STYLES */
.card {
    background-color: var(--white);
    border-radius: var(--border-radius-medium);
    padding: 24px;
    margin-bottom: 24px;
    box-shadow: var(--shadow-subtle);
    position: relative;
    overflow: hidden;
}

.card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: var(--primary-gradient);
    opacity: 0;
    transition: var(--transition);
}

.card:hover::before {
    opacity: 1;
}

.card-title {
    display: flex;
    align-items: center;
    margin-bottom: 20px;
}

.card-title .icon {
    margin-right: 12px;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 10px;
    background: var(--primary-gradient);
    color: var(--white);
}

.card-title .icon span {
    font-size: 20px;
}

.card-title h2 {
    margin-bottom: 0;
}

.step-number {
    font-size: 14px;
    color: var(--medium);
    margin-bottom: 8px;
    letter-spacing: 0.5px;
    font-weight: 400;
}

/* OPTION TILES */
.option-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 16px;
    margin-top: 20px;
}

.option-tile {
    background-color: var(--white);
    border-radius: var(--border-radius-medium);
    padding: 20px 16px;
    box-shadow: var(--shadow-subtle);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    cursor: pointer;
    transition: var(--transition);
    position: relative;
    overflow: hidden;
    border: 1px solid var(--light);
    height: 150px;
}

.option-tile::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--primary);
    opacity: 0;
    transition: var(--transition);
    z-index: 0;
}

.option-tile.selected {
    border-color: var(--primary);
    transform: translateY(-2px);
    box-shadow: var(--shadow-medium);
}

.option-tile.selected::before {
    opacity: 0.05;
}

.option-tile .icon {
    color: var(--primary);
    margin-bottom: 12px;
    font-size: 36px;
    position: relative;
    z-index: 1;
    transition: var(--transition);
}

.option-tile h3 {
    font-size: 15px;
    font-weight: 400;
    margin-bottom: 4px;
    color: var(--dark);
    position: relative;
    z-index: 1;
    transition: var(--transition);
}

.option-tile p {
    font-size: 12px;
    color: var(--medium);
    position: relative;
    z-index: 1;
    transition: var(--transition);
}

.option-tile:hover {
    box-shadow: var(--shadow-medium);
    transform: translateY(-2px);
}

.option-tile.selected .icon {
    color: var(--primary);
}

.selected-indicator {
    position: absolute;
    top: 10px;
    right: 10px;
    width: 18px;
    height: 18px;
    background-color: var(--primary);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transform: scale(0);
    transition: var(--transition);
    z-index: 2;
}

.selected-indicator span {
    color: white;
    font-size: 14px;
    font-weight: bold;
}

.option-tile.selected .selected-indicator {
    opacity: 1;
    transform: scale(1);
}

/* FORM CONTROLS */
.form-group {
    margin-bottom: 24px;
}

.form-label {
    display: block;
    font-size: 14px;
    font-weight: 400;
    color: var(--dark);
    margin-bottom: 8px;
}

.input-control {
    background-color: var(--light);
    border: none;
    border-radius: var(--border-radius-small);
    padding: 12px 16px;
    font-size: 16px;
    font-weight: 300;
    color: var(--dark);
    width: 100%;
    outline: none;
    transition: var(--transition);
}

.input-control:focus {
    box-shadow: 0 0 0 2px var(--primary);
}

.input-control::placeholder {
    color: var(--light-medium);
}

.input-group {
    display: flex;
    align-items: center;
    gap: 10px;
}

.input-group .input-control {
    flex: 1;
}

/* TOGGLE SWITCH */
.toggle-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 16px;
}

.toggle-label {
    font-size: 14px;
    color: var(--dark);
    font-weight: 400;
}

.toggle {
    position: relative;
    width: 50px;
    height: 30px;
}

.toggle input {
    opacity: 0;
    width: 0;
    height: 0;
}

.toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--light-medium);
    transition: var(--transition);
    border-radius: 30px;
}

.toggle-slider:before {
    position: absolute;
    content: "";
    height: 26px;
    width: 26px;
    left: 2px;
    bottom: 2px;
    background-color: var(--white);
    transition: var(--transition);
    border-radius: 50%;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

input:checked + .toggle-slider {
    background-color: var(--primary);
}

input:checked + .toggle-slider:before {
    transform: translateX(20px);
}

/* SEGMENTED CONTROL */
.segmented-control {
    display: flex;
    background-color: var(--light);
    border-radius: var(--border-radius-small);
    padding: 2px;
    position: relative;
    margin-bottom: 16px;
}

.segment-btn {
    padding: 8px 16px;
    flex: 1;
    text-align: center;
    font-size: 14px;
    font-weight: 400;
    color: var(--medium);
    border: none;
    background: none;
    cursor: pointer;
    position: relative;
    z-index: 1;
    transition: var(--transition);
    border-radius: var(--border-radius-small);
}

.segment-btn.active {
    color: var(--white);
}

.segment-btn:focus {
    outline: none;
}

.segmented-control::after {
    content: '';
    position: absolute;
    top: 2px;
    left: 2px;
    height: calc(100% - 4px);
    width: calc(33.333% - 4px);
    background: var(--primary-gradient);
    border-radius: calc(var(--border-radius-small) - 2px);
    transition: var(--transition);
    z-index: 0;
}

.segmented-control[data-active="1"]::after {
    transform: translateX(0);
}

.segmented-control[data-active="2"]::after {
    transform: translateX(100%);
}

.segmented-control[data-active="3"]::after {
    transform: translateX(200%);
}

/* SLIDER */
.slider-container {
    margin-bottom: 24px;
}

.slider-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.slider-value {
    font-size: 14px;
    font-weight: 400;
    color: var(--primary);
}

.slider {
    -webkit-appearance: none;
    appearance: none;
    width: 100%;
    height: 4px;
    border-radius: 2px;
    background: var(--light-medium);
    outline: none;
}

.slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: var(--primary-gradient);
    cursor: pointer;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.slider::-moz-range-thumb {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: var(--primary-gradient);
    cursor: pointer;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    border: none;
}

/* WEEK DAY PICKER */
.weekday-picker {
    display: flex;
    justify-content: space-between;
    max-width: 380px;
    margin-top: 8px;
}

.weekday {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    cursor: pointer;
    transition: var(--transition);
    color: var(--medium);
    background-color: var(--light);
    user-select: none;
}

.weekday.selected {
    background-color: var(--primary);
    color: var(--white);
    font-weight: 400;
}

/* ADVANCED OPTIONS */
.options-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.option-panel {
    background-color: var(--white);
    border-radius: var(--border-radius-medium);
    box-shadow: var(--shadow-subtle);
    overflow: hidden;
    transition: var(--transition);
    border: 1px solid var(--light);
}

.option-panel-header {
    padding: 16px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 1px solid var(--light);
}

.option-panel-title {
    display: flex;
    align-items: center;
}

.option-panel-title .icon {
    margin-right: 12px;
    color: var(--primary);
    font-size: 20px;
}

.option-panel-title span {
    font-size: 15px;
    font-weight: 400;
}

.option-panel-content {
    padding: 16px;
    opacity: 0.5;
    pointer-events: none;
    transition: var(--transition);
}

.option-panel-content.active {
    opacity: 1;
    pointer-events: auto;
}

/* BUTTONS */
.button-container {
    display: flex;
    justify-content: center;
    gap: 16px;
    margin-top: 30px;
}

.btn {
    padding: 12px 24px;
    font-size: 15px;
    font-weight: 400;
    border-radius: var(--border-radius-small);
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
    min-width: 150px;
}

.btn span.icon {
    margin-right: 8px;
    font-size: 20px;
}

.btn-primary {
    background: var(--primary-gradient);
    color: var(--white);
    box-shadow: 0 4px 10px rgba(0, 122, 255, 0.2);
}

.btn-secondary {
    background-color: var(--light);
    color: var(--dark);
}

.btn-danger {
    background: var(--danger-gradient);
    color: var(--white);
    box-shadow: 0 4px 10px rgba(255, 59, 48, 0.2);
}

.btn:hover {
    transform: translateY(-2px);
}

.btn-primary:hover {
    box-shadow: 0 6px 15px rgba(0, 122, 255, 0.3);
}

.btn-danger:hover {
    box-shadow: 0 6px 15px rgba(255, 59, 48, 0.3);
}

/* THEME SWITCH */
.theme-switch-wrapper {
    display: flex;
    justify-content: center;
    margin-top: 20px;
}

.theme-switch {
    position: relative;
    display: inline-block;
    width: 60px;
    height: 34px;
}

.theme-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.theme-switch .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--light);
    transition: var(--transition);
    border-radius: 34px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 5px;
}

.theme-switch .slider:before {
    position: absolute;
    content: "";
    height: 26px;
    width: 26px;
    left: 4px;
    bottom: 4px;
    background-color: var(--white);
    transition: var(--transition);
    border-radius: 50%;
    z-index: 2;
}

.theme-switch input:checked + .slider {
    background-color: var(--dark);
}

.theme-switch input:checked + .slider:before {
    transform: translateX(26px);
}

.sun-icon, .moon-icon {
    font-size: 14px;
    color: var(--medium);
    z-index: 1;
}

.sun-icon {
    margin-left: 2px;
}

.moon-icon {
    color: var(--light-medium);
}

/* BATTERY INDICATOR */
.battery-indicator {
    position: fixed;
    top: 20px;
    right: 20px;
    background-color: var(--white);
    border-radius: var(--border-radius-large);
    padding: 8px 15px;
    display: flex;
    align-items: center;
    box-shadow: var(--shadow-medium);
    z-index: 100;
    transition: var(--transition);
}

.battery-indicator .icon {
    color: var(--primary);
    margin-right: 8px;
}

.battery-level {
    font-size: 14px;
    font-weight: 500;
}

/* CONFETTI EFFECT */
.confetti {
    position: fixed;
    width: 10px;
    height: 10px;
    background-color: #f2f2f2;
    opacity: 0;
    z-index: 1000;
    animation: fall 3s ease-out forwards;
    pointer-events: none;
}

@keyframes fall {
    0% {
        transform: translateY(-100vh) rotate(0deg);
        opacity: 1;
    }
    80% {
        opacity: 1;
    }
    100% {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
    }
}

/* DARK MODE STYLES */
body.dark-mode {
    background-color: var(--dark-bg);
    color: var(--dark-text);
}

body.dark-mode .card {
    background-color: var(--dark-card);
    border-color: var(--dark-border);
}

body.dark-mode h2, 
body.dark-mode .card-title h2,
body.dark-mode .option-panel-title span {
    color: var(--dark-text);
}

body.dark-mode p,
body.dark-mode .toggle-label,
body.dark-mode .form-label {
    color: var(--dark-text-secondary);
}

body.dark-mode .input-control,
body.dark-mode .segmented-control,
body.dark-mode .weekday,
body.dark-mode .option-tile {
    background-color: var(--dark-input-bg);
    border-color: var(--dark-border);
    color: var(--dark-text);
}

body.dark-mode .option-tile h3 {
    color: var(--dark-text);
}

body.dark-mode .option-tile p {
    color: var(--dark-text-secondary);
}

body.dark-mode .btn-secondary {
    background-color: var(--dark-input-bg);
    color: var(--dark-text);
}

body.dark-mode .option-panel {
    background-color: var(--dark-card);
    border-color: var(--dark-border);
}

body.dark-mode .option-panel-header {
    border-color: var(--dark-border);
}

body.dark-mode .battery-indicator {
    background-color: var(--dark-card);
    color: var(--dark-text);
}

/* FOOTER */
footer {
    margin-top: 60px;
    text-align: center;
    padding: 20px;
    color: var(--medium);
    font-size: 13px;
    font-weight: 300;
    transition: var(--transition);
}

body.dark-mode footer {
    color: var(--dark-text-secondary);
}

/* 새 스타일: 빠른 복사 및 통합 생성 도구 */
.preview-container {
    background-color: var(--light);
    border-radius: var(--border-radius-medium);
    padding: 16px;
    margin-top: 20px;
    display: none;
    transition: var(--transition);
    overflow: hidden;
    position: relative;
}

body.dark-mode .preview-container {
    background-color: var(--dark-input-bg);
}

.preview-container.show {
    display: block;
    animation: slideDown 0.3s ease forwards;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.preview-filename {
    font-size: 14px;
    font-weight: 500;
    color: var(--dark);
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

body.dark-mode .preview-filename {
    color: var(--dark-text);
}

.preview-filename-input {
    background: none;
    border: none;
    font-size: 14px;
    font-weight: 500;
    color: var(--primary);
    border-bottom: 1px dashed var(--primary);
    padding: 0 0 2px 0;
    margin-left: 8px;
    width: auto;
    min-width: 100px;
    outline: none;
}

.preview-code {
    font-family: Consolas, Monaco, 'Andale Mono', monospace;
    font-size: 13px;
    line-height: 1.4;
    color: var(--dark);
    padding: 12px;
    background-color: var(--white);
    border-radius: var(--border-radius-small);
    max-height: 300px;
    overflow-y: auto;
    white-space: pre;
    position: relative;
    border: 1px solid var(--light-medium);
    margin-bottom: 16px;
}

body.dark-mode .preview-code {
    background-color: var(--dark-card);
    color: var(--dark-text);
    border-color: var(--dark-border);
}

.preview-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 16px;
}

.action-item {
    flex: 1;
    min-width: 120px;
    padding: 12px;
    border-radius: var(--border-radius-small);
    background-color: var(--white);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    cursor: pointer;
    transition: var(--transition);
    box-shadow: var(--shadow-subtle);
    position: relative;
    overflow: hidden;
}

body.dark-mode .action-item {
    background-color: var(--dark-card);
}

.action-item:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-medium);
}

.action-item .icon {
    font-size: 24px;
    color: var(--primary);
    margin-bottom: 8px;
}

.action-item.txt .icon {
    color: var(--medium);
}

.action-item.email .icon {
    color: var(--warning);
}

.action-item.copy .icon {
    color: var(--secondary);
}

.action-item h4 {
    font-size: 14px;
    font-weight: 400;
    margin: 0;
    color: var(--dark);
}

body.dark-mode .action-item h4 {
    color: var(--dark-text);
}

.action-item p {
    font-size: 12px;
    color: var(--medium);
    margin: 4px 0 0 0;
}

.copy-indicator {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--secondary);
    color: var(--white);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 500;
    opacity: 0;
    transform: translateY(100%);
    transition: var(--transition);
}

.copy-indicator.show {
    opacity: 1;
    transform: translateY(0);
}

.action-tooltip {
    position: absolute;
    bottom: -40px;
    left: 50%;
    transform: translateX(-50%);
    background-color: var(--dark);
    color: var(--white);
    padding: 6px 12px;
    border-radius: var(--border-radius-small);
    font-size: 12px;
    white-space: nowrap;
    opacity: 0;
    transition: var(--transition);
    pointer-events: none;
    z-index: 10;
}

.action-tooltip::before {
    content: '';
    position: absolute;
    top: -6px;
    left: 50%;
    transform: translateX(-50%);
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-bottom: 6px solid var(--dark);
}

.action-item:hover .action-tooltip {
    opacity: 1;
    bottom: -30px;
}

.floating-actions {
    position: fixed;
    bottom: 20px;
    right: 20px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    z-index: 100;
}

.floating-btn {
    width: 56px;
    height: 56px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: var(--shadow-medium);
    cursor: pointer;
    transition: var(--transition);
}

.floating-btn:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
}

.floating-btn.primary {
    background: var(--primary-gradient);
    color: var(--white);
}

.floating-btn.warning {
    background: var(--warning-gradient);
    color: var(--white);
}

.floating-btn .icon {
    font-size: 24px;
}

.notification {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: var(--white);
    border-radius: var(--border-radius-medium);
    padding: 16px 20px;
    display: flex;
    align-items: center;
    box-shadow: var(--shadow-medium);
    z-index: 1000;
    opacity: 0;
    transition: var(--transition);
    pointer-events: none;
    max-width: 90%;
}

.notification.show {
    opacity: 1;
    pointer-events: auto;
}

.notification .icon {
    margin-right: 12px;
    font-size: 24px;
}

.notification.success .icon {
    color: var(--secondary);
}

.notification.warning .icon {
    color: var(--warning);
}

.notification.error .icon {
    color: var(--danger);
}

.notification-message {
    flex: 1;
}

.notification-title {
    font-size: 14px;
    font-weight: 500;
    color: var(--dark);
    margin: 0;
}

.notification-text {
    font-size: 13px;
    color: var(--medium);
    margin: 4px 0 0 0;
}

.notification-close {
    margin-left: 12px;
    color: var(--medium);
    cursor: pointer;
    font-size: 20px;
    transition: var(--transition);
}

.notification-close:hover {
    color: var(--dark);
}

body.dark-mode .notification {
    background-color: var(--dark-card);
}

body.dark-mode .notification-title {
    color: var(--dark-text);
}

body.dark-mode .notification-close:hover {
    color: var(--dark-text);
}

.generate-btn-text {
    display: none;
}

.generate-btn-text.show {
    display: inline;
}

/* RESPONSIVE */
@media (max-width: 768px) {
    .option-grid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    }

    .options-grid {
        grid-template-columns: 1fr;
    }

    .button-container {
        flex-direction: column;
    }

    .btn {
        width: 100%;
    }

    .preview-actions {
        flex-direction: column;
    }

    .action-item {
        width: 100%;
    }

    .weekday-picker {
        flex-wrap: wrap;
        justify-content: center;
        gap: 8px;
    }

    .input-group {
        flex-direction: column;
    }
    
    .segmented-control {
        flex-wrap: wrap;
    }
    
    .segment-btn {
        padding: 10px;
    }

    .option-tile {
        height: 130px;
        padding: 16px 10px;
    }
    
    .option-tile .icon {
        font-size: 28px;
    }
}
</style>
</head>
<body>
<div class="container">
<header>
    <h1>Power Manager</h1>
    <p class="description">시스템 전원 관리를 위한 완벽한 설정 도구</p>
    
    <div class="theme-switch-wrapper">
        <label class="theme-switch">
            <input type="checkbox" id="dark-mode-toggle">
            <div class="slider round">
                <span class="material-symbols-rounded sun-icon">light_mode</span>
                <span class="material-symbols-rounded moon-icon">dark_mode</span>
            </div>
        </label>
    </div>
</header>

<!-- Power Options -->
<div class="card">
    <div class="step-number">Step 1</div>
    <div class="card-title">
        <div class="icon">
            <span class="material-symbols-rounded">power_settings_new</span>
        </div>
        <h2>전원 옵션 선택</h2>
    </div>
    <p>필요한 전원 관리 옵션을 선택하세요</p>

    <div class="option-grid">
        <div class="option-tile" onclick="selectPowerOption(this)">
            <div class="selected-indicator">
                <span class="material-symbols-rounded">check</span>
            </div>
            <span class="material-symbols-rounded icon">power_settings_new</span>
            <h3>시스템 종료</h3>
            <p>전원을 완전히 끕니다</p>
        </div>
        <div class="option-tile" onclick="selectPowerOption(this)">
            <div class="selected-indicator">
                <span class="material-symbols-rounded">check</span>
            </div>
            <span class="material-symbols-rounded icon">restart_alt</span>
            <h3>시스템 재시작</h3>
            <p>전원을 다시 시작합니다</p>
        </div>
        <div class="option-tile" onclick="selectPowerOption(this)">
            <div class="selected-indicator">
                <span class="material-symbols-rounded">check</span>
            </div>
            <span class="material-symbols-rounded icon">nightlight</span>
            <h3>절전 모드</h3>
            <p>전력 소비를 줄입니다</p>
        </div>
        <div class="option-tile" onclick="selectPowerOption(this)">
            <div class="selected-indicator">
                <span class="material-symbols-rounded">check</span>
            </div>
            <span class="material-symbols-rounded icon">hotel</span>
            <h3>최대 절전 모드</h3>
            <p>상태를 저장합니다</p>
        </div>
        <div class="option-tile" onclick="selectPowerOption(this)">
            <div class="selected-indicator">
                <span class="material-symbols-rounded">check</span>
            </div>
            <span class="material-symbols-rounded icon">logout</span>
            <h3>로그오프</h3>
            <p>사용자 세션 종료</p>
        </div>
    </div>
</div>

<!-- Timer Settings -->
<div class="card">
    <div class="step-number">Step 2</div>
    <div class="card-title">
        <div class="icon">
            <span class="material-symbols-rounded">timer</span>
        </div>
        <h2>타이머 설정</h2>
    </div>
    <p>명령이 실행될 시간을 설정하세요</p>

    <div class="toggle-container">
        <div class="toggle-label">타이머 활성화</div>
        <label class="toggle">
            <input type="checkbox" id="timer-toggle" onchange="toggleTimerSettings()">
            <span class="toggle-slider"></span>
        </label>
    </div>

    <div id="timer-settings" style="opacity: 0.5; pointer-events: none;">
        <div class="input-group">
            <input type="number" class="input-control" min="1" max="999" value="30" id="timer-value">
            <div class="segmented-control" data-active="1">
                <button class="segment-btn active" onclick="selectTimeUnit(this, 1)">초</button>
                <button class="segment-btn" onclick="selectTimeUnit(this, 2)">분</button>
                <button class="segment-btn" onclick="selectTimeUnit(this, 3)">시간</button>
            </div>
        </div>
    </div>
</div>

<!-- Advanced Options -->
<div class="card">
    <div class="step-number">Step 3</div>
    <div class="card-title">
        <div class="icon">
            <span class="material-symbols-rounded">tune</span>
        </div>
        <h2>고급 설정</h2>
    </div>
    <p>필요에 맞게 추가 옵션을 구성하세요</p>

    <div class="options-grid">
        <!-- Notifications Panel -->
        <div class="option-panel">
            <div class="option-panel-header">
                <div class="option-panel-title">
                    <span class="material-symbols-rounded icon">notifications</span>
                    <span>알림 설정</span>
                </div>
                <label class="toggle">
                    <input type="checkbox" onchange="toggleOptionPanel(this)">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="option-panel-content">
                <div class="form-group">
                    <label class="form-label">알림 표시 시점</label>
                    <div class="segmented-control" data-active="1">
                        <button class="segment-btn active" onclick="selectOption(this, 1)">1분 전</button>
                        <button class="segment-btn" onclick="selectOption(this, 2)">5분 전</button>
                        <button class="segment-btn" onclick="selectOption(this, 3)">10분 전</button>
                    </div>
                </div>
                <div class="toggle-container">
                    <div class="toggle-label">소리 알림</div>
                    <label class="toggle">
                        <input type="checkbox">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>
        </div>

        <!-- Conditional Execution Panel -->
        <div class="option-panel">
            <div class="option-panel-header">
                <div class="option-panel-title">
                    <span class="material-symbols-rounded icon">settings_applications</span>
                    <span>조건부 실행</span>
                </div>
                <label class="toggle">
                    <input type="checkbox" onchange="toggleOptionPanel(this)">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="option-panel-content">
                <div class="slider-container">
                    <div class="slider-top">
                        <label class="form-label">CPU 사용량 임계값</label>
                        <div class="slider-value">30%</div>
                    </div>
                    <input type="range" class="slider" min="5" max="95" value="30" step="5" 
                        oninput="this.previousElementSibling.querySelector('.slider-value').textContent = this.value + '%'">
                    <input type="hidden" value="30%">
                </div>
                <div class="form-group">
                    <label class="form-label">지속 시간(분)</label>
                    <input type="number" min="1" max="60" value="5" class="input-control">
                </div>
            </div>
        </div>

        <!-- Schedule Panel -->
        <div class="option-panel">
            <div class="option-panel-header">
                <div class="option-panel-title">
                    <span class="material-symbols-rounded icon">schedule</span>
                    <span>예약 설정</span>
                </div>
                <label class="toggle">
                    <input type="checkbox" onchange="toggleOptionPanel(this)">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="option-panel-content">
                <div class="form-group">
                    <label class="form-label">실행 시간</label>
                    <input type="time" class="input-control">
                </div>
                <div class="form-group">
                    <label class="form-label">요일 선택</label>
                    <div class="weekday-picker">
                        <div class="weekday" onclick="toggleWeekday(this)">월</div>
                        <div class="weekday" onclick="toggleWeekday(this)">화</div>
                        <div class="weekday" onclick="toggleWeekday(this)">수</div>
                        <div class="weekday" onclick="toggleWeekday(this)">목</div>
                        <div class="weekday" onclick="toggleWeekday(this)">금</div>
                        <div class="weekday" onclick="toggleWeekday(this)">토</div>
                        <div class="weekday" onclick="toggleWeekday(this)">일</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Generate Script -->
<div class="card">
    <div class="step-number">Step 4</div>
    <div class="card-title">
        <div class="icon">
            <span class="material-symbols-rounded">code</span>
        </div>
        <h2>스크립트 생성</h2>
    </div>
    <p>설정한 옵션으로 배치 파일을 생성합니다</p>

    <div class="button-container">
        <button class="btn btn-primary" id="generate-btn" onclick="generateBatchFile()">
            <span class="material-symbols-rounded icon">play_arrow</span>
            <span class="generate-btn-text" id="generate-text-default">배치 파일 생성</span>
            <span class="generate-btn-text" id="generate-text-refresh">스크립트 업데이트</span>
        </button>
        <button class="btn btn-secondary" id="reset-btn" onclick="resetSettings()">
            <span class="material-symbols-rounded icon">refresh</span>
            설정 초기화
        </button>
        <button class="btn btn-danger" id="cancel-btn" onclick="generateCancelFile()">
            <span class="material-symbols-rounded icon">cancel</span>
            종료 취소 파일
        </button>
    </div>

    <!-- 새로운 미리보기 및 생성 도구 -->
    <div class="preview-container" id="preview-container">
        <div class="preview-filename">
            파일명: <input type="text" class="preview-filename-input" id="preview-filename" value="power_manager.bat">
        </div>
        <pre class="preview-code" id="preview-code"></pre>
        
        <div class="preview-actions">
            <div class="action-item copy" onclick="copyToClipboard()">
                <span class="material-symbols-rounded icon">content_copy</span>
                <h4>클립보드에 복사</h4>
                <p>코드를 메모장에 붙여넣기</p>
                <div class="copy-indicator" id="copy-indicator">복사 완료!</div>
                <div class="action-tooltip">코드를 클립보드에 복사한 후 메모장에 붙여넣기</div>
            </div>
            
            <div class="action-item" onclick="downloadAsTxt()">
                <span class="material-symbols-rounded icon">text_snippet</span>
                <h4>텍스트 파일로 저장</h4>
                <p>나중에 .bat로 변경</p>
                <div class="action-tooltip">텍스트(.txt) 파일로 저장 후 확장자를 .bat으로 변경</div>
            </div>
            
            <div class="action-item" onclick="openInNotepad()">
                <span class="material-symbols-rounded icon">edit_document</span>
                <h4>메모장에서 열기</h4>
                <p>바로 편집하고 저장</p>
                <div class="action-tooltip">메모장을 열고 코드를 자동으로 붙여넣기</div>
            </div>

            <div class="action-item email" onclick="sendViaEmail()">
                <span class="material-symbols-rounded icon">mail</span>
                <h4>이메일로 받기</h4>
                <p>PC에 다운로드</p>
                <div class="action-tooltip">파일을 이메일로 보내서 다른 PC에서 다운로드</div>
            </div>
        </div>
    </div>
</div>

<footer>
    <p>© 2025 Power Manager | 시스템 파워 관리 도구</p>
</footer>
</div>

<!-- 알림 -->
<div class="notification" id="notification">
    <span class="material-symbols-rounded icon"></span>
    <div class="notification-message">
        <h4 class="notification-title"></h4>
        <p class="notification-text"></p>
    </div>
    <span class="material-symbols-rounded notification-close" onclick="closeNotification()">close</span>
</div>

<!-- 플로팅 액션 버튼 -->
<div class="floating-actions">
    <div class="floating-btn primary" onclick="generateBatchFile()" title="빠른 파일 생성">
        <span class="material-symbols-rounded icon">bolt</span>
    </div>
    <div class="floating-btn warning" onclick="generateCancelFile()" title="빠른 취소 파일 생성">
        <span class="material-symbols-rounded icon">cancel</span>
    </div>
</div>

<script>
// 배치 파일 생성 관련 함수
// 미리보기 표시 함수
function togglePreview(show = true) {
    const previewContainer = document.getElementById('preview-container');
    if (show) {
        previewContainer.classList.add('show');
        
        // 배치 파일 생성 버튼 텍스트 업데이트
        document.getElementById('generate-text-default').classList.remove('show');
        document.getElementById('generate-text-refresh').classList.add('show');
    } else {
        previewContainer.classList.remove('show');
        
        // 배치 파일 생성 버튼 텍스트 초기화
        document.getElementById('generate-text-default').classList.add('show');
        document.getElementById('generate-text-refresh').classList.remove('show');
    }
}

// 알림 표시 함수
function showNotification(type, title, message, duration = 5000) {
    const notification = document.getElementById('notification');
    const icon = notification.querySelector('.icon');
    const titleEl = notification.querySelector('.notification-title');
    const textEl = notification.querySelector('.notification-text');
    
    // 알림 유형에 따른 아이콘 및 스타일 설정
    notification.className = 'notification ' + type;
    
    if (type === 'success') {
        icon.textContent = 'check_circle';
    } else if (type === 'warning') {
        icon.textContent = 'warning';
    } else if (type === 'error') {
        icon.textContent = 'error';
    } else {
        icon.textContent = 'info';
    }
    
    // 내용 설정
    titleEl.textContent = title;
    textEl.textContent = message;
    
    // 표시
    notification.classList.add('show');
    
    // 자동 닫기
    if (window.notificationTimeout) {
        clearTimeout(window.notificationTimeout);
    }
    window.notificationTimeout = setTimeout(() => {
        closeNotification();
    }, duration);
}

// 알림 닫기 함수
function closeNotification() {
    const notification = document.getElementById('notification');
    notification.classList.remove('show');
}

// 일반 배치 파일 내용 생성 - 고급 설정 적용 추가
function generateBatchContent(powerCommand, powerAction, timeParameter = '', timeInfo = '즉시') {
    let batchContent = '@echo off\n';
    batchContent += 'echo Power Manager - 전원 관리 스크립트\n';
    batchContent += 'echo ================================\n\n';
    
    // ASCII 아트 추가
    batchContent += 'echo  _____                       __  __                                 \n';
    batchContent += 'echo |  __ \\                     |  \\/  |                                \n';
    batchContent += 'echo | |__) |____      _____ _ __| \\  / | __ _ _ __   __ _  __ _  ___ _ __\n';
    batchContent += 'echo |  ___/ _ \\ \\ /\\ / / _ \\ \'__| |\\/| |/ _` | \'_ \\ / _` |/ _` |/ _ \\ \'__|\n';
    batchContent += 'echo | |  | (_) \\ V  V /  __/ |  | |  | | (_| | | | | (_| | (_| |  __/ |   \n';
    batchContent += 'echo |_|   \\___/ \\_/\\_/ \\___|_|  |_|  |_|\\__,_|_| |_|\\__,_|\\__, |\\___|_|   \n';
    batchContent += 'echo                                                       __/ |          \n';
    batchContent += 'echo                                                      |___/           \n\n';
    
    // 보안 경고 안내
    batchContent += 'echo [주의] 이 파일을 실행할 때 Windows 보안 경고가 표시될 수 있습니다.\n';
    batchContent += 'echo 이 경우 파일을 마우스 오른쪽 버튼으로 클릭 후 속성에서 "차단 해제"를 선택하세요.\n\n';
    
    // 1. 알림 설정 적용
    const notificationPanel = document.querySelectorAll('.option-panel')[0];
    const notificationToggle = notificationPanel.querySelector('input[type="checkbox"]');
    let notificationTimeText = '';
    
    if (notificationToggle.checked) {
        const notifTime = notificationPanel.querySelector('.segment-btn.active').textContent;
        notificationTimeText = notifTime;
        batchContent += 'echo 전원 관리 작업이 실행됩니다...\n';
        batchContent += `echo 작업 ${notifTime}에 알림이 표시됩니다.\n\n`;
        
        // 소리 알림 추가
        const soundToggle = notificationPanel.querySelector('.toggle-container input[type="checkbox"]');
        if (soundToggle.checked) {
            batchContent += `echo 알림 시 소리가 재생됩니다.\n`;
            batchContent += `echo \a\n`;  // 비프음 추가
        }
    }
    
    // 2. 조건부 실행 설정 적용
    const conditionalPanel = document.querySelectorAll('.option-panel')[1];
    const conditionalToggle = conditionalPanel.querySelector('input[type="checkbox"]');
    
    if (conditionalToggle.checked) {
        const cpuThreshold = conditionalPanel.querySelector('.slider-value').textContent;
        const duration = conditionalPanel.querySelector('.input-control').value;
        
        batchContent += `echo 조건부 실행이 설정되었습니다:\n`;
        batchContent += `echo - CPU 사용량이 ${cpuThreshold} 미만일 때\n`;
        batchContent += `echo - ${duration}분 동안 유지될 경우 작업이 실행됩니다\n\n`;
        
        // CPU 사용량 확인 코드 추가 (Windows 환경에서 작동)
        batchContent += `echo CPU 사용량 확인 중...\n`;
        batchContent += `wmic cpu get loadpercentage > %temp%\\cpu_usage.txt\n`;
        batchContent += `set /p CPU_USAGE=<%temp%\\cpu_usage.txt\n`;
        batchContent += `set CPU_USAGE=%CPU_USAGE:LoadPercentage=%\n`;
        batchContent += `set CPU_USAGE=%CPU_USAGE: =%\n`;
        batchContent += `echo 현재 CPU 사용량: %CPU_USAGE%%%\n\n`;
        
        // 임계값 체크
        batchContent += `set CPU_THRESHOLD=${cpuThreshold.replace('%', '')}\n`;
        batchContent += `set WAIT_MINUTES=${duration}\n\n`;
        
        batchContent += `set /a WAIT_SECONDS=WAIT_MINUTES*60\n\n`;
        
        batchContent += `if %CPU_USAGE% GTR %CPU_THRESHOLD% (\n`;
        batchContent += `    echo CPU 사용량이 임계값을 초과합니다. 작업이 연기됩니다.\n`;
        batchContent += `    exit /b\n`;
        batchContent += `)\n\n`;
        
        batchContent += `echo CPU 사용량이 임계값 이하입니다. ${duration}분 대기 후 작업이 실행됩니다.\n`;
        batchContent += `timeout /t %WAIT_SECONDS% /nobreak\n\n`;
    }
    
    // 3. 예약 설정 적용
    const schedulePanel = document.querySelectorAll('.option-panel')[2];
    const scheduleToggle = schedulePanel.querySelector('input[type="checkbox"]');
    
    if (scheduleToggle.checked) {
        const execTime = schedulePanel.querySelector('input[type="time"]').value;
        const selectedDays = schedulePanel.querySelectorAll('.weekday.selected');
        
        // 요일 텍스트 가져오기
        let daysText = '매일';
        if (selectedDays.length > 0 && selectedDays.length < 7) {
            const dayNames = Array.from(selectedDays).map(day => day.textContent);
            daysText = dayNames.join(', ');
        }
        
        batchContent += `echo 예약 설정이 적용되었습니다:\n`;
        batchContent += `echo - 실행 시간: ${execTime}\n`;
        batchContent += `echo - 실행 요일: ${daysText}\n\n`;
        
        // 스케줄러 명령 추가
        const timeComponents = execTime.split(':');
        const hours = timeComponents[0];
        const minutes = timeComponents[1];
        
        // 요일 코드 변환 (월:MON, 화:TUE, ...)
        const dayCodeMap = {
            '월': 'MON', '화': 'TUE', '수': 'WED', '목': 'THU', 
            '금': 'FRI', '토': 'SAT', '일': 'SUN'
        };
        
        let dayString = "*";
        if (selectedDays.length > 0 && selectedDays.length < 7) {
            const dayCodes = Array.from(selectedDays).map(day => dayCodeMap[day.textContent]);
            dayString = dayCodes.join(',');
        }
        
        // 임시 배치파일 생성하는 코드
        const taskName = `PowerManager_${powerAction}`;
        batchContent += `echo 작업 스케줄러에 예약 작업을 생성합니다...\n`;
        batchContent += `echo @echo off > "%temp%\\pm_task.bat"\n`;
        
        // 실제 명령 추가
        batchContent += `echo ${powerCommand}${timeParameter} >> "%temp%\\pm_task.bat"\n\n`;
        
        // 작업 스케줄러 명령 추가
        batchContent += `schtasks /create /f /tn "${taskName}" /tr "%temp%\\pm_task.bat" /sc WEEKLY /d ${dayString} /st ${hours}:${minutes} /ru "%USERNAME%"\n\n`;
        batchContent += `echo 다음 일정으로 예약되었습니다: ${daysText} ${execTime}\n`;
        batchContent += `echo 예약된 작업은 '작업 스케줄러'에서 확인 및 수정할 수 있습니다.\n\n`;
        
        // 이 배치 파일은 스케줄러를 설정하는 역할만 담당
        return batchContent;
    }
    
    // 기본 정보 표시
    batchContent += `echo ${timeInfo}에 ${powerAction} 작업이 수행됩니다.\n\n`;
    
    // 종료 명령이면 취소 안내 추가
    if (powerCommand.includes('shutdown')) {
        batchContent += 'echo 작업을 취소하려면 "shutdown -a" 명령어를 실행하거나\n';
        batchContent += 'echo 함께 제공된 "취소" 배치 파일을 실행하세요.\n\n';
    }
    
    // 알림 설정 적용 - 실제 작업 실행 전 알림
    if (notificationToggle.checked && timeParameter && notificationTimeText) {
        const notifTimeValue = parseInt(notificationTimeText);
        let notifSeconds = 60; // 기본값 1분
        
        if (notificationTimeText.includes('5분')) {
            notifSeconds = 5 * 60;
        } else if (notificationTimeText.includes('10분')) {
            notifSeconds = 10 * 60;
        }
        
        // 실제 종료 전에 알림 표시하는 코드
        const timeValue = parseInt(timeParameter.replace(/[^0-9]/g, ''));
        if (timeValue > notifSeconds) {
            const remainTime = timeValue - notifSeconds;
            batchContent += `timeout /t ${remainTime} /nobreak\n`;
            batchContent += `echo 알림: ${notificationTimeText} 후에 ${powerAction} 작업이 실행됩니다.\n`;
            batchContent += `echo \a\n`;  // 알림음
            batchContent += `timeout /t ${notifSeconds} /nobreak\n\n`;
        }
    }
    
    // 최종 명령 추가
    batchContent += `${powerCommand}${timeParameter}`;
    
    return batchContent;
}

// 배치 파일 생성 (수정됨)
function generateBatchFile() {
    try {
        // Get selected power option
        let selectedPowerOption = document.querySelector('.option-tile.selected');
        let powerCommand = "";
        let powerAction = "";
        
        if (!selectedPowerOption) {
            showNotification('warning', '옵션 필요', '전원 옵션을 선택해주세요!');
            return;
        }
        
        // Create confetti effect
        createConfetti();
        
        // Determine power command based on selection
        const powerOptionText = selectedPowerOption.querySelector('h3').textContent;
        
        switch(powerOptionText) {
            case '시스템 종료':
                powerCommand = 'shutdown /s';
                powerAction = "종료";
                break;
            case '시스템 재시작':
                powerCommand = 'shutdown /r';
                powerAction = "재시작";
                break;
            case '절전 모드':
                powerCommand = 'powercfg -hibernate off & rundll32.exe powrprof.dll,SetSuspendState 0,1,0';
                powerAction = "절전모드";
                break;
            case '최대 절전 모드':
                powerCommand = 'shutdown /h';
                powerAction = "최대절전모드";
                break;
            case '로그오프':
                powerCommand = 'shutdown /l';
                powerAction = "로그오프";
                break;
            default:
                powerCommand = 'shutdown /s';
                powerAction = "종료";
        }
        
        // Check if timer is enabled
        let timeParameter = '';
        let timeInfo = '즉시';
        const timerToggle = document.getElementById('timer-toggle');
        
        if (timerToggle.checked) {
            const timerValue = document.getElementById('timer-value').value;
            const timeUnit = document.querySelector('.segmented-control[data-active] .segment-btn.active').textContent;
            let seconds = 0;
            
            switch(timeUnit) {
                case '초':
                    seconds = timerValue;
                    timeInfo = `${timerValue}초후`;
                    break;
                case '분':
                    seconds = timerValue * 60;
                    timeInfo = `${timerValue}분후`;
                    break;
                case '시간':
                    seconds = timerValue * 3600;
                    timeInfo = `${timerValue}시간후`;
                    break;
            }
            
            if (powerCommand.includes('shutdown')) {
                timeParameter = ` /t ${seconds}`;
            }
        }
        
        // 예약 설정이 활성화된 경우 특별한 파일명
        const schedulePanel = document.querySelectorAll('.option-panel')[2];
        const scheduleToggle = schedulePanel.querySelector('input[type="checkbox"]');
        let isScheduled = scheduleToggle.checked;
        
        // 배치 파일 내용 생성
        const batchContent = generateBatchContent(powerCommand, powerAction, timeParameter, timeInfo);
        
        // 미리보기 표시 및 내용 설정
        document.getElementById('preview-code').textContent = batchContent;
        
        // 파일명 설정 - 예약 설정인 경우 다른 파일명 사용
        if (isScheduled) {
            const execTime = schedulePanel.querySelector('input[type="time"]').value;
            document.getElementById('preview-filename').value = `예약_${execTime}_${powerAction}.bat`;
        } else {
            document.getElementById('preview-filename').value = `${timeInfo}_${powerAction}.bat`;
        }
        
        togglePreview(true);
        
        // 생성 버튼이 처음 눌린 경우에만 알림 표시
        if (!document.getElementById('generate-text-refresh').classList.contains('show')) {
            showNotification('success', '배치 파일 생성 완료', 
                '배치 파일 코드가 생성되었습니다. 다음 단계에서 원하는 방식으로 저장하세요.');
        }
    } catch (error) {
        console.error('파일 생성 오류:', error);
        showNotification('error', '배치 파일 생성 오류', '배치 파일 생성 중 오류가 발생했습니다.');
    }
}

// Cancel batch file - 수정된 함수
function generateCancelFile() {
    try {
        // 취소 배치 파일 내용 생성
        const cancelContent = generateCancelContent();
        
        // 미리보기 업데이트
        document.getElementById('preview-code').textContent = cancelContent;
        document.getElementById('preview-filename').value = '종료취소.bat';
        
        // 미리보기 표시
        togglePreview(true);
        
        // 알림 표시
        showNotification('success', '취소 파일 생성 완료', 
            '종료 취소 파일이 생성되었습니다. 다음 단계에서 원하는 방식으로 저장하세요.');
    } catch (error) {
        console.error('취소 파일 생성 오류:', error);
        showNotification('error', '취소 파일 생성 오류', '취소 파일 생성 중 오류가 발생했습니다.');
    }
}

// Select power option - renamed to avoid conflict
function selectPowerOption(element) {
    const parent = element.parentElement;
    const allOptions = parent.querySelectorAll('.option-tile');
    
    allOptions.forEach(option => {
        option.classList.remove('selected');
    });
    
    element.classList.add('selected');
    
    // Add animation effect when selecting
    element.style.transform = 'scale(1.05)';
    setTimeout(() => {
        element.style.transform = '';
    }, 300);
    
    // 이미 미리보기가 표시된 상태라면 배치 파일 내용 업데이트
    if (document.getElementById('preview-container').classList.contains('show')) {
        generateBatchFile();
    }
}

// Toggle timer settings
function toggleTimerSettings() {
    const timerSettings = document.getElementById('timer-settings');
    const timerToggle = document.getElementById('timer-toggle');
    
    if (timerToggle.checked) {
        timerSettings.style.opacity = '1';
        timerSettings.style.pointerEvents = 'auto';
    } else {
        timerSettings.style.opacity = '0.5';
        timerSettings.style.pointerEvents = 'none';
    }
    
    // 이미 미리보기가 표시된 상태라면 배치 파일 내용 업데이트
    if (document.getElementById('preview-container').classList.contains('show')) {
        generateBatchFile();
    }
}

// Select time unit
function selectTimeUnit(element, position) {
    const parent = element.parentElement;
    const allButtons = parent.querySelectorAll('.segment-btn');
    
    allButtons.forEach(btn => {
        btn.classList.remove('active');
    });
    
    element.classList.add('active');
    parent.dataset.active = position;
    
    // 이미 미리보기가 표시된 상태라면 배치 파일 내용 업데이트
    if (document.getElementById('preview-container').classList.contains('show')) {
        generateBatchFile();
    }
}

// Toggle option panel
function toggleOptionPanel(checkbox) {
    const panel = checkbox.closest('.option-panel');
    const content = panel.querySelector('.option-panel-content');
    
    if (checkbox.checked) {
        content.classList.add('active');
    } else {
        content.classList.remove('active');
    }
    
    // 이미 미리보기가 표시된 상태라면 배치 파일 내용 업데이트
    if (document.getElementById('preview-container').classList.contains('show')) {
        generateBatchFile();
    }
}

// Select option in segment control
function selectOption(element, position) {
    const parent = element.parentElement;
    const allButtons = parent.querySelectorAll('.segment-btn');
    
    allButtons.forEach(btn => {
        btn.classList.remove('active');
    });
    
    element.classList.add('active');
    if (position) {
        parent.dataset.active = position;
    }
    
    // 이미 미리보기가 표시된 상태라면 배치 파일 내용 업데이트
    if (document.getElementById('preview-container').classList.contains('show')) {
        generateBatchFile();
    }
}

// Toggle weekday selection
function toggleWeekday(day) {
    day.classList.toggle('selected');
    
    // 이미 미리보기가 표시된 상태라면 배치 파일 내용 업데이트
    if (document.getElementById('preview-container').classList.contains('show')) {
        generateBatchFile();
    }
}

// Create confetti effect
function createConfetti() {
    const colors = ['#FF3B30', '#FF9500', '#FFCC00', '#34C759', '#5AC8FA', '#007AFF', '#5856D6', '#AF52DE'];
    const confettiCount = 100;
    
    for (let i = 0; i < confettiCount; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = Math.random() * 100 + 'vw';
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.width = Math.random() * 10 + 5 + 'px';
        confetti.style.height = Math.random() * 10 + 5 + 'px';
        confetti.style.animationDuration = Math.random() * 2 + 2 + 's';
        document.body.appendChild(confetti);
        
        // Remove confetti after animation ends
        setTimeout(() => {
            confetti.remove();
        }, 4000);
    }
}

// Reset all settings
function resetSettings() {
    // Reset power options
    const selectedPowerOption = document.querySelector('.option-tile.selected');
    if (selectedPowerOption) {
        selectedPowerOption.classList.remove('selected');
    }
    
    // Reset timer
    const timerToggle = document.getElementById('timer-toggle');
    timerToggle.checked = false;
    toggleTimerSettings();
    
    document.getElementById('timer-value').value = '30';
    
    const timeUnitControl = document.querySelector('.segmented-control');
    timeUnitControl.dataset.active = '1';
    
    const timeUnitButtons = timeUnitControl.querySelectorAll('.segment-btn');
    timeUnitButtons.forEach(btn => btn.classList.remove('active'));
    timeUnitButtons[0].classList.add('active');
    
    // Reset option panels
    const optionToggles = document.querySelectorAll('.option-panel input[type="checkbox"]');
    optionToggles.forEach(toggle => {
        toggle.checked = false;
        toggleOptionPanel(toggle);
    });
    
    // Reset weekdays
    const selectedWeekdays = document.querySelectorAll('.weekday.selected');
    selectedWeekdays.forEach(day => day.classList.remove('selected'));
    
    // Reset sliders and other inputs
    const sliders = document.querySelectorAll('.slider');
    sliders.forEach(slider => {
        slider.value = slider.defaultValue;
        const valueDisplay = slider.previousElementSibling.querySelector('.slider-value');
        if (valueDisplay) {
            valueDisplay.textContent = `${slider.value}%`;
        }
    });
    
    // 미리보기 영역 숨김
    togglePreview(false);
    
    // 알림 표시
    showNotification('success', '설정 초기화', '모든 설정이 초기화되었습니다.');
}

// Toggle dark mode
function toggleDarkMode() {
    document.body.classList.toggle('dark-mode');
}

// Display battery status
function displayBatteryStatus() {
    try {
        if ('getBattery' in navigator || ('battery' in navigator && 'Promise' in window)) {
            const batteryPromise = 'getBattery' in navigator ? 
                navigator.getBattery() : 
                Promise.resolve(navigator.battery);
            
            batteryPromise.then(battery => {
                function updateBatteryStatus() {
                    const batteryLevel = Math.floor(battery.level * 100);
                    
                    // Create battery indicator if it doesn't exist
                    let batteryIndicator = document.querySelector('.battery-indicator');
                    if (!batteryIndicator) {
                        batteryIndicator = document.createElement('div');
                        batteryIndicator.className = 'battery-indicator';
                        
                        const batteryIcon = document.createElement('span');
                        batteryIcon.className = 'material-symbols-rounded icon';
                        
                        const batteryText = document.createElement('span');
                        batteryText.className = 'battery-level';
                        
                        batteryIndicator.appendChild(batteryIcon);
                        batteryIndicator.appendChild(batteryText);
                        document.body.appendChild(batteryIndicator);
                    }
                    
                    const batteryIcon = batteryIndicator.querySelector('.icon');
                    const batteryText = batteryIndicator.querySelector('.battery-level');
                    
                    // Update battery icon based on level
                    if (battery.charging) {
                        batteryIcon.textContent = 'battery_charging_full';
                    } else if (batteryLevel <= 20) {
                        batteryIcon.textContent = 'battery_alert';
                        batteryIcon.style.color = 'var(--danger)';
                    } else if (batteryLevel <= 50) {
                        batteryIcon.textContent = 'battery_5_bar';
                        batteryIcon.style.color = 'var(--warning)';
                    } else {
                        batteryIcon.textContent = 'battery_full';
                        batteryIcon.style.color = 'var(--secondary)';
                    }
                    
                    batteryText.textContent = `${batteryLevel}%`;
                }
                
                // Update battery status initially and when it changes
                updateBatteryStatus();
                battery.addEventListener('levelchange', updateBatteryStatus);
                battery.addEventListener('chargingchange', updateBatteryStatus);
            })
            .catch(error => {
                console.log('Battery status API not supported');
            });
        }
    } catch (error) {
        console.log('Battery status API access error:', error);
    }
}

// 파일명 입력 필드 감시 함수
function setupFilenameListener() {
    const filenameInput = document.getElementById('preview-filename');
    filenameInput.addEventListener('input', function() {
        // 확장자가 없으면 .bat 추가
        if (!this.value.toLowerCase().endsWith('.bat')) {
            this.value = this.value.replace(/\.[^/.]+$/, '') + '.bat';
        }
    });
    
    filenameInput.addEventListener('blur', function() {
        // 확장자가 없으면 .bat 추가
        if (!this.value.toLowerCase().endsWith('.bat')) {
            this.value = this.value + '.bat';
        }
    });
}

// Initialize the app
document.addEventListener('DOMContentLoaded', function() {
    // Initialize segmented controls
    const timeUnitButtons = document.querySelectorAll('.segmented-control .segment-btn');
    timeUnitButtons[0].classList.add('active');
    
    // Setup dark mode toggle
    const darkModeToggle = document.getElementById('dark-mode-toggle');
    darkModeToggle.addEventListener('change', toggleDarkMode);
    
    // 기본 생성 버튼 텍스트 표시
    document.getElementById('generate-text-default').classList.add('show');
    
    // 파일명 입력 감시 설정
    setupFilenameListener();
    
    // Initialize battery status display
    displayBatteryStatus();
    
    // Easter egg - konami code
    let konamiCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];
    let konamiPosition = 0;
    
    document.addEventListener('keydown', function(e) {
        // Check if the key matches the next key in the konami code
        if (e.key === konamiCode[konamiPosition]) {
            konamiPosition++;
            
            // If the entire sequence is entered correctly
            if (konamiPosition === konamiCode.length) {
                createConfetti();
                showNotification('success', '이스터 에그 발견!', '축하합니다! 숨겨진 기능을 발견하셨습니다!');
                konamiPosition = 0;
            }
        } else {
            konamiPosition = 0;
        }
    });
});
</script>
</body>
</html>